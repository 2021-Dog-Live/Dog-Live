<template>
  <div class="main-body main-padding">
    <div style="width:100%; ">
      <bread-crumb></bread-crumb>
      <el-card
        class="box-card"
        style="width:100%; height:auto;  border:none;"
        shadow="none"
      >
        <div>
          <el-form
            style=" margin:100px; padding-left:10px; padding-right:10px;"
            label-position="left"
            :model="ruleForm"
            :rules="rules"
            ref="ruleForm"
          >
            <h5
              class="pt-3 pb-3"
              style="font-weight:600; padding-left:20px; background:linear-gradient( to top,  #f3ede7, #f5e9e4 );"
            >
              üìë Í∏∞Î≥∏Ï†ïÎ≥¥Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî
            </h5>

            <el-row class="mt-4 mb-3">
              <el-col :span="12">
                <el-form-item label="Ï†úÎ™©" prop="title" label-width="30%">
                  <el-input
                    style="width:65%;"
                    v-model="ruleForm.title"
                  ></el-input>
                </el-form-item>
              </el-col>
              <el-col :span="12">
                <el-form-item label-width="30%" label="Í∞ïÏïÑÏßÄ Ïù¥Î¶Ñ" prop="name">
                  <el-input
                    style="width:70%;"
                    v-model="ruleForm.name"
                  ></el-input>
                </el-form-item>
              </el-col>
            </el-row>
            <el-row> </el-row>

            <el-row class="mt-3 mb-3">
              <el-col :span="10">
                <el-row>
                  <el-col :span="12">
                    <el-form-item
                      label="Í≥µÍ≥† ÌÉÄÏûÖ"
                      prop="type"
                      label-width="90%"
                    >
                      <el-select
                        style="width:90%;"
                        v-model="state.board.boardType.id"
                        placeholder="Î∂ÑÎ•ò"
                      >
                        <el-option label="ÏûÖÏñë" :value="1"></el-option>
                        <el-option label="ÏûÑÎ≥¥" :value="2"></el-option>
                      </el-select>
                    </el-form-item>
                  </el-col>
                  <el-col :span="12">
                    <el-form-item label="Ïó∞Î†πÎåÄ" prop="age">
                      <el-select
                        style="width:90%;"
                        v-model="state.board.ageType.id"
                        placeholder="Ïó∞Î†πÎåÄ"
                      >
                        <el-option
                          label="Puppy(~ 6Í∞úÏõî)"
                          :value="4"
                        ></el-option>
                        <el-option
                          label="Junior(7Í∞úÏõî ~ 2ÏÇ¥)"
                          :value="5"
                        ></el-option>
                        <el-option
                          label="Adult(3ÏÇ¥ ~ 8ÏÇ¥)"
                          :value="6"
                        ></el-option>
                        <el-option label="Senior(9ÏÇ¥ ~)" :value="7"></el-option>
                      </el-select>
                    </el-form-item>
                  </el-col>
                </el-row>
              </el-col>
              <el-col :span="10">
                <el-row>
                  <el-col :span="12">
                    <el-form-item label="ÌÅ¨Í∏∞" prop="size">
                      <el-select
                        style="width:90%;"
                        v-model="state.board.weight.id"
                        placeholder="ÌÅ¨Í∏∞"
                      >
                        <el-option label="ÏÜå(8kg ÎØ∏Îßå)" :value="1"></el-option>
                        <el-option
                          label="Ï§ë(8kg-18kg ÎØ∏Îßå)"
                          :value="2"
                        ></el-option>
                        <el-option label="ÎåÄ(18kg Ïù¥ÏÉÅ)" :value="3"></el-option>
                      </el-select>
                    </el-form-item>
                  </el-col>
                  <el-col :span="12">
                    <el-form-item
                      label-width="100%"
                      label="ÌíàÏ¢Ö"
                      prop="dogType"
                    >
                      <el-select
                        v-model="state.board.dogType.id"
                        placeholder="ÌíàÏ¢Ö"
                        style="width:90%;"
                      >
                        <el-option
                          v-for="dog in state.dogTypeList"
                          :key="dog.id"
                          :label="dog.name"
                          :value="dog.id"
                        >
                        </el-option>
                      </el-select>
                    </el-form-item>
                  </el-col>
                </el-row>
              </el-col>
              <el-col :span="4">
                <el-form-item
                  label="Ï§ëÏÑ±Ìôî Ïó¨Î∂Ä"
                  label-width="100%"
                  label-position="center"
                  prop="neutralization"
                >
                  <el-radio-group
                    style="width:100%;"
                    v-model="ruleForm.neutralization"
                  >
                    <el-radio
                      label="O"
                      style="margin-left:10%; margin-right:10%;"
                      border
                    ></el-radio>
                    <el-radio label="X" border></el-radio>
                  </el-radio-group>
                </el-form-item>
              </el-col>
            </el-row>
            <el-row>
              <el-col :span="15">
                <el-row>
                  <el-col :span="12">
                    <el-form-item
                      label="Í±∞Ï£ºÏßÄ(Ïãú/ÎèÑ)"
                      prop="sido"
                      label-width="100%"
                    >
                      <el-select
                        v-model="state.board.sido.id"
                        placeholder="Ïãú/ÎèÑ"
                        style="width:95% ;"
                        @change="gugunList(state.board.sido.id)"
                      >
                        <el-option
                          v-for="(sido, idx) in state.sidoList"
                          :key="idx"
                          :label="sido.name"
                          :value="sido.id"
                        >
                        </el-option>
                      </el-select>
                    </el-form-item>
                  </el-col>
                  <el-col :span="12">
                    <el-form-item
                      label="(Íµ¨/Íµ∞)"
                      prop="gugun"
                      label-width="100%"
                    >
                      <el-select
                        style="width:95% ;"
                        v-model="state.board.gugun.id"
                        placeholder="Íµ¨/Íµ∞"
                      >
                        <el-option
                          v-for="(gugun, idx) in state.gugunList"
                          :key="idx"
                          :label="gugun.name"
                          :value="gugun.id"
                        >
                        </el-option>
                      </el-select>
                    </el-form-item>
                  </el-col>
                </el-row>
              </el-col>
              <el-col :span="5">
                <el-row>
                  <el-col :span="24">
                    <el-form-item label="Ïª¨Îü¨" prop="color" label-width="100%">
                      <el-select
                        style="width:90%;"
                        v-model="state.board.colorType.id"
                        placeholder="Ïª¨Îü¨"
                      >
                        <el-option label="White" :value="12"></el-option>
                        <el-option label="Beige" :value="13"></el-option>
                        <el-option label="Gray" :value="14"></el-option>
                        <el-option label="Brown" :value="15"></el-option>
                        <el-option label="Black" :value="16"></el-option>
                      </el-select>
                    </el-form-item>
                  </el-col>
                </el-row>
              </el-col>
              <el-col :span="4">
                <el-form-item label="ÏÑ±Î≥Ñ" label-width="100%" prop="gender">
                  <el-radio-group v-model="ruleForm.gender" style="width:100%;">
                    <el-radio
                      style="margin-left:10%; margin-right:10%;"
                      label="ÎÇ®"
                      border
                    ></el-radio>
                    <el-radio label="Ïó¨" border></el-radio>
                  </el-radio-group>
                </el-form-item>
              </el-col>
            </el-row>

            <el-row class="mt-3">
              <el-form-item label="Î∂ÄÍ∞Ä ÏÑ§Î™Ö" prop="desc">
                <el-input
                  type="textarea"
                  :rows="7"
                  maxlength="1000"
                  v-model="ruleForm.desc"
                ></el-input>
              </el-form-item>
            </el-row>

            <div class="mb-3" style="margin-top:100px;"></div>

            <h5
              class="pt-3 pb-3"
              style="font-weight:600; padding-left:20px; background:linear-gradient( to top,  #f3ede7, #f5e9e4 );"
            >
              üê∂ ÏÑ±Í≤©ÏùÑ ÏÜåÍ∞úÌï¥Ï£ºÏÑ∏Ïöî
            </h5>

            <el-row class="mt-4 mb-3" style="margin-left:5%; margin:right:5%;">
              <el-col :span="12">
                <el-form-item label="ÌôúÎèôÏÑ±Ìñ•" prop="energy" label-width="30%">
                  <el-radio-group v-model="ruleForm.energy">
                    <el-popover placement="top" width="200" trigger="hover">
                      <h6 style="font-weight:600">ÏóêÎÑàÏßÄ Energetic</h6>
                      ÌôúÎèôÏ†Å, Ï¶âÌù•Ï†ÅÏù∏
                      <template #reference>
                        <el-radio label="ÏóêÎÑàÏßÄÏûàÎäî" border></el-radio>
                      </template>
                    </el-popover>
                    <el-popover placement="top" width="200" trigger="hover">
                      <h6 style="font-weight:600 ;">
                        Ïπ®Ï∞©Ìïú Introversion
                      </h6>
                      Ï∞®Î∂ÑÌïú, ÏùºÍ¥ÄÏ†ÅÏù∏
                      <template #reference>
                        <el-radio label="Ïπ®Ï∞©Ìïú" border></el-radio>
                      </template>
                    </el-popover>
                  </el-radio-group>
                </el-form-item>
              </el-col>
              <el-col :span="12">
                <el-form-item
                  label="ÏàúÏ¢ÖÏÑ±Ìñ•"
                  prop="obedience"
                  label-width="30%"
                >
                  <el-radio-group v-model="ruleForm.obedience">
                    <el-popover placement="top" width="200" trigger="hover">
                      <h6 style="font-weight:600">Ï∂©ÏÑ±Ïã¨ Í∞ïÌïú Supportive</h6>
                      Ïú†ÏàúÌïú, ÏÑ±Ïã§Ìïú
                      <template #reference>
                        <el-radio label="Ï∂©ÏÑ±Ïã¨ Í∞ïÌïú" border></el-radio>
                      </template>
                    </el-popover>
                    <el-popover placement="top" width="200" trigger="hover">
                      <h6 style="font-weight:600">ÏòÅÎ¶¨Ìïú Naughty</h6>
                      Ïû¨ÏπòÌïú, ÎòëÎòëÌïú
                      <template #reference>
                        <el-radio label="ÏòÅÎ¶¨Ìïú" border></el-radio>
                      </template>
                    </el-popover>
                  </el-radio-group>
                </el-form-item>
              </el-col>
            </el-row>
            <el-row style="margin-left:5%; margin:right:5%;">
              <el-col :span="12">
                <el-form-item
                  label="Í¥ÄÍ≥ÑÏÑ±Ìñ•"
                  prop="relationship"
                  label-width="30%"
                >
                  <el-radio-group v-model="ruleForm.relationship">
                    <el-popover placement="bottom" width="200" trigger="hover">
                      <h6 style="font-weight:600">Í¥ÄÍ≥ÑÏßÄÌñ• Friendly</h6>
                      Î∞òÎ†§Ïù∏ Î∞îÎùºÍ∏∞
                      <template #reference>
                        <el-radio label="ÏùòÏ°¥Ï†ÅÏù∏" border></el-radio>
                      </template>
                    </el-popover>
                    <el-popover placement="bottom" width="200" trigger="hover">
                      <h6 style="font-weight:600">ÎèÖÎ¶ΩÏßÄÌñ• independenT</h6>
                      Ïä§Ïä§Î°ú ÌñâÎèôÌïòÎäî
                      <template #reference>
                        <el-radio label="ÎèÖÎ¶ΩÏ†ÅÏù∏" border></el-radio>
                      </template>
                    </el-popover>
                  </el-radio-group>
                </el-form-item>
              </el-col>
              <el-col :span="12">
                <el-form-item
                  label="Ï†ÅÏùëÏÑ±Ìñ•"
                  prop="adaptability"
                  label-width="30%"
                >
                  <div>
                    <el-radio-group v-model="ruleForm.adaptability">
                      <el-popover
                        placement="bottom"
                        width="200"
                        trigger="hover"
                      >
                        <h6 style="font-weight:600">Ïã†Ï§ëÌïú Prudent</h6>
                        ÎÇØÍ∞ÄÎ¶¨Îäî, Ï°∞Ïã¨Ïä§Îü¨Ïö¥

                        <template #reference>
                          <el-radio label="ÎÇØÍ∞ÄÎ¶¨Îäî" border></el-radio>
                        </template>
                      </el-popover>
                      <el-popover
                        placement="bottom"
                        width="200"
                        trigger="hover"
                      >
                        <h6 style="font-weight:600">ÏπúÌôîÏ†ÅÏù∏ Jolly</h6>
                        Î™®Îì† Í≤ÉÏóê Ìò∏Í∏∞Ïã¨ Í∞ÄÎìùÌïú
                        <template #reference>
                          <el-radio label="ÏπúÌôîÏ†ÅÏù∏" border></el-radio>
                        </template>
                      </el-popover>
                    </el-radio-group>
                  </div>
                </el-form-item>
              </el-col>
            </el-row>
            <div class="mb-3" style="margin-top:100px;"></div>
            <div
              class="pt-3 pb-3"
              style="font-weight:600; padding-left:20px; background:linear-gradient( to top,  #f3ede7, #f5e9e4 );"
            >
              <span style="font-size: 1.25rem; font-weight:600">
                üì∑ ÏÇ¨ÏßÑÏùÑ ÏóÖÎ°úÎìú Ìï¥Ï£ºÏÑ∏Ïöî
              </span>
              <span> (ÏµúÎåÄ 5Ïû• / ÏµúÏÜå 2Ïû•)</span>
            </div>
            <el-row class="mt-4  mb-3">
              <div class="mb-3" id="imgFileUploadInsertWrapper">
                <div
                  id="imgFileUploadInsertThumbnail"
                  class="thumbnail-wrapper"
                >
                  <el-image
                    style="width: 200px; height:200px; box-shadow:0 2px 12px 0 rgb(0 0 0 / 10%); cursor:pointer; position:relative; margin-right:20px; border-radius:20px; float:left;"
                    v-for="(file, index) in state.board.fileList"
                    v-bind:src="file"
                    v-bind:key="index"
                    @click="deleteOriginFile(index)"
                    :fit="fit"
                    :hover="state.hover"
                  ></el-image>
                  <el-image
                    style="width: 200px; height:200px; box-shadow:0 2px 12px 0 rgb(0 0 0 / 10%); cursor:pointer; position:relative; margin-right:20px; border-radius:20px; float:left;"
                    v-for="(file, index) in state.thumbnailList"
                    v-bind:src="file"
                    v-bind:key="index"
                    @click="deleteNewFile(index)"
                    :fit="fit"
                    :hover="state.hover"
                  ></el-image>

                  <input
                    @change="changeFile"
                    type="file"
                    id="inputFileUploadInsert"
                    style="display:none"
                    multiple
                  />
                  <div style="float:left;">
                    <label for="inputFileUploadInsert" style="cursor:pointer;">
                      <div
                        style="background:linear-gradient( to top, #f3ede7, #f5e9e4 );
                      text-align:center;
display:table-cell;
vertical-align:middle; box-shadow:0 2px 12px 0 rgb(0 0 0 / 10%);
                      width:200px; height:200px; border-radius:20px;
                    "
                      >
                        <i
                          class="el-icon-plus "
                          style="margin-left : 10px;
                    font-size:40px; color:#D8D8D8;"
                        />
                      </div>
                    </label>
                  </div>
                </div>
              </div>
            </el-row>

            <el-row
              class="mt-5"
              style=" display: flex;
  justify-content: center;"
            >
              <el-button type="primary" @click="submitForm('ruleForm')"
                >ÏàòÏ†ï</el-button
              >
              <el-button @click="resetForm('ruleForm')">Ï¥àÍ∏∞Ìôî</el-button>
            </el-row>
          </el-form>
        </div>
      </el-card>
    </div>
  </div>
</template>

<script>
import BreadCrumb from "./components/bread-crumb.vue";
import { computed, reactive, onMounted } from "vue";
import { useStore } from "vuex";
import { useRouter } from "vue-router";
import { createToast } from "mosha-vue-toastify";
import "mosha-vue-toastify/dist/style.css";

export default {
  name: "AdoptModify",
  components: {
    BreadCrumb
  },
  data() {
    return {
      ruleForm: {
        sido: this.state.board.sido.id,
        gugun: this.state.board.gugun.id,
        type: this.state.board.boardType.id,
        title: this.state.board.title,
        name: this.state.board.dogName,
        gender: this.state.board.gender.name,
        dogType: this.state.board.dogType.id,
        color: this.state.board.colorType.id,
        age: this.state.board.ageType.id,
        size: this.state.board.weight.id,
        neutralization: this.state.board.neutralization == true ? "O" : "X",

        desc: this.state.board.description,
        energy:
          this.state.board.mbti.indexOf("E") == 0 ? "ÏóêÎÑàÏßÄÏûàÎäî" : "Ïπ®Ï∞©Ìïú",
        obedience:
          this.state.board.mbti.indexOf("S") == 1 ? "Ï∂©ÏÑ±Ïã¨ Í∞ïÌïú" : "ÏòÅÎ¶¨Ìïú",
        relationship:
          this.state.board.mbti.indexOf("F") == 2 ? "ÏùòÏ°¥Ï†ÅÏù∏" : "ÎèÖÎ¶ΩÏ†ÅÏù∏",
        adaptability:
          this.state.board.mbti.indexOf("P") == 3 ? "ÎÇØÍ∞ÄÎ¶¨Îäî" : "ÏπúÌôîÏ†ÅÏù∏"
      },
      rules: {
        type: [
          {
            required: true,
            message: "Í≥µÍ≥† ÌÉÄÏûÖÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî",
            trigger: "change"
          }
        ],
        title: [
          {
            required: true,
            message: "Ï†úÎ™©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.",
            trigger: "change"
          },
          {
            min: 3,
            max: 20,
            message: "3Í∏ÄÏûê Ïù¥ÏÉÅ, 20Í∏ÄÏûê Ïù¥ÌïòÎ°ú ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.",
            trigger: "change"
          }
        ],
        name: [
          {
            required: true,
            message: "Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.",
            trigger: "change"
          },
          {
            min: 1,
            max: 10,
            message: "10Í∏ÄÏûê Ïù¥ÌïòÎ°ú ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.",
            trigger: "change"
          }
        ],
        gender: [
          { required: true, message: "ÏÑ±Î≥ÑÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî", trigger: "change" }
        ],
        dogType: [
          {
            required: true,
            message: "ÌíàÏ¢ÖÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî",
            trigger: "change"
          }
        ],
        sido: [
          {
            required: true,
            message: "Ï£ºÏÜåÏßÄÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.",
            trigger: "change"
          }
        ],
        gugun: [
          {
            required: true,
            message: "Ï£ºÏÜåÏßÄÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.",
            trigger: "change"
          }
        ],
        color: [
          {
            required: true,
            message: "Ïª¨Îü¨ÌÉÄÏûÖÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî",
            trigger: "change"
          }
        ],
        age: [
          {
            required: true,
            message: "Ïó∞Î†πÎåÄÎ•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî",
            trigger: "change"
          }
        ],
        size: [
          { required: true, message: "ÌÅ¨Í∏∞Î•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî", trigger: "change" }
        ],
        neutralization: [
          {
            required: true,
            message: "Ï§ëÏÑ±ÌôîÏó¨Î∂ÄÎ•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî",
            trigger: "change"
          }
        ],

        desc: [
          {
            required: true,
            message: "ÏÑ§Î™ÖÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî (ÏÜåÍ∞úÍ∏Ä, ÌäπÏù¥ÏÇ¨Ìï≠ Îì±)",
            trigger: "change"
          },
          {
            min: 50,
            max: 1000,
            message: "50Í∏ÄÏûê Ïù¥ÏÉÅ, 1000Í∏ÄÏûê Ïù¥ÌïòÎ°ú ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.",
            trigger: "change"
          }
        ],
        energy: [
          {
            required: true,
            message: "ÌôúÎèôÏÑ±Ìñ•ÏùÑ Í¥ÄÏ∞∞ ÌõÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî",
            trigger: "change"
          }
        ],
        obedience: [
          {
            required: true,
            message: "ÏàúÏ¢ÖÏÑ±Ìñ•ÏùÑ Í¥ÄÏ∞∞ ÌõÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî",
            trigger: "change"
          }
        ],
        relationship: [
          {
            required: true,
            message: "Í¥ÄÍ≥ÑÏÑ±Ìñ•ÏùÑ Í¥ÄÏ∞∞ ÌõÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî",
            trigger: "change"
          }
        ],
        adaptability: [
          {
            required: true,
            message: "Ï†ÅÏùëÏÑ±Ìñ•ÏùÑ Í¥ÄÏ∞∞ ÌõÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî",
            trigger: "change"
          }
        ]
      }
    };
  },

  methods: {
    submitForm(formName) {
      if (this.state.board.fileList.length + this.state.newAddFile.length > 5) {
        createToast("ÏÇ¨ÏßÑÏùÄ 5Ïû•ÍπåÏßÄÎßå ÏóÖÎ°úÎìú Í∞ÄÎä•Ìï¥Ïöî üí¨üí¶", {
          hideProgressBar: "true",
          timeout: 4500,
          showIcon: "true",
          toastBackgroundColor: "#c49d83",
          position: "bottom-left",
          transition: "bounce",
          type: "warning"
        });
      } else if (
        this.state.board.fileList.length + this.state.newAddFile.length >=
        2
      ) {
        const mbti =
          [this.ruleForm.energy == "ÏóêÎÑàÏßÄÏûàÎäî" ? "E" : "I"] +
          [this.ruleForm.obedience == "Ï∂©ÏÑ±Ïã¨ Í∞ïÌïú" ? "S" : "N"] +
          [this.ruleForm.relationship == "ÏùòÏ°¥Ï†ÅÏù∏" ? "F" : "T"] +
          [this.ruleForm.adaptability == "ÏπúÌôîÏ†ÅÏù∏" ? "J" : "P"];

        const data = {
          mbti: mbti,
          title: this.ruleForm.title,
          dogName: this.ruleForm.name,
          gender: this.ruleForm.gender,
          desc: this.ruleForm.desc,
          neutralization: this.ruleForm.neutralization
        };
        this.$refs[formName].validate(valid => {
          if (valid) {
            this.modifyData(data);
          } else {
            createToast("ÏûëÏÑ±ÌïòÏßÄ ÏïäÏùÄ Ìï≠Î™©Ïù¥ ÏûàÏñ¥Ïöî üí¨üí¶", {
              hideProgressBar: "true",
              timeout: 4500,
              showIcon: "true",
              toastBackgroundColor: "#c49d83",
              position: "bottom-left",
              transition: "bounce",
              type: "warning"
            });
          }
        });
      } else {
        createToast("ÏÇ¨ÏßÑÏùÄ Îëê Ïû• Ïù¥ÏÉÅ ÏóÖÎ°úÎìúÌï¥Ï£ºÏÑ∏Ïöî üí¨üí¶", {
          hideProgressBar: "true",
          timeout: 4500,
          showIcon: "true",
          toastBackgroundColor: "#c49d83",
          position: "bottom-left",
          transition: "bounce",
          type: "warning"
        });
      }
    },
    resetForm(formName) {
      this.$refs[formName].resetFields();
    }
  },

  setup() {
    const store = new useStore();
    const router = new useRouter();

    const state = reactive({
      board: store.getters["root/getBoardDetail"],
      deleteList: [],
      newAddFile: [],
      thumbnailList: [],
      dogTypeList: [],
      userId: computed(() => {
        return store.getters["root/getLoginUserInfo"];
      }),
      sidoList: [],
      gugunList: []
    });

    const modifyData = function(data) {
      if (state.board.gugun.id == null) {
        createToast("ÏûëÏÑ±ÌïòÏßÄ ÏïäÏùÄ Ìï≠Î™©Ïù¥ ÏûàÏñ¥Ïöî üí¨üí¶", {
          hideProgressBar: "true",
          timeout: 4500,
          showIcon: "true",
          toastBackgroundColor: "#c49d83",
          position: "bottom-left",
          transition: "bounce",
          type: "warning"
        });
      } else {
        const formData = new FormData();
        formData.append("userId", state.userId.userId);
        formData.append("boardType", state.board.boardType.id);
        formData.append("dogName", data.dogName);
        formData.append("mbti", data.mbti);
        formData.append("title", data.title);
        formData.append("description", data.desc);
        formData.append("colorType", state.board.colorType.id);
        formData.append("age", state.board.ageType.id);
        formData.append("dogType", state.board.dogType.id);
        formData.append("gender", data.gender == "Ïó¨" ? 8 : 9);
        formData.append(
          "neutralization",
          data.neutralization == "O" ? true : false
        );
        formData.append("weight", state.board.weight.id);
        formData.append("gugun", state.board.gugun.id);

        const cnt = this.state.deleteList.length;
        for (var i = 0; i < cnt; i++) {
          formData.append("delList", this.state.deleteList[i]);
        }

        for (var j = 0; j < this.state.newAddFile.length; j++) {
          formData.append("fileList", this.state.newAddFile[j]);
        }

        store
          .dispatch("root/requestModifyBoard", {
            boardId: state.board.boardId,
            data: formData
          })
          .then(function(result) {
            store
              .dispatch("root/requestBoardDetail", {
                boardId: state.board.boardId,
                userId: state.userId.userId
              })
              .then(function(result) {
                const boardDetail = {
                  boardId: result.data.dogInformation.boardId.id,
                  boardType: result.data.dogInformation.boardId.type,
                  thumbnailUrl: result.data.dogInformation.boardId.thumbnailUrl,
                  title: result.data.dogInformation.boardId.title,
                  address: result.data.dogInformation.address,
                  mbti: result.data.dogInformation.mbti,
                  colorType: result.data.dogInformation.colorType,
                  gender: result.data.dogInformation.gender,
                  dogType: result.data.dogInformation.dogType,
                  neutralization: result.data.dogInformation.neutralization,
                  writer: result.data.writer,
                  weight: result.data.dogInformation.weight,
                  ageType: result.data.dogInformation.age,
                  regDate: result.data.dogInformation.boardId.regDate,
                  fileList: result.data.boardImageList,
                  isOwner: result.data.owner,
                  gugun: result.data.dogInformation.gugun,
                  sido: result.data.dogInformation.gugun.sidoCode,
                  description: result.data.dogInformation.description,
                  dogName: result.data.dogInformation.dogName,
                  isBookmarked: result.data.bookmarked
                };

                createToast("Í≥µÍ≥†Í∞Ä ÏàòÏ†ïÎêòÏóàÏñ¥Ïöî üìúüêæ", {
                  hideProgressBar: "true",
                  timeout: 4500,
                  showIcon: "true",
                  toastBackgroundColor: "#7eaa72",
                  position: "bottom-left",
                  transition: "bounce",
                  type: "success"
                });
                store.commit("root/setBoardDetail", boardDetail);
                router.push({ name: "AdoptDetail" });
              })
              .catch(function(err) {
                console.log(err);
              });
          })
          .catch(function(err) {
            createToast("Í≥µÍ≥† ÏàòÏ†ïÏóê Ïã§Ìå®ÌñàÏñ¥Ïöî üò±üí¶", {
              hideProgressBar: "true",
              timeout: 4500,
              showIcon: "true",
              toastBackgroundColor: "#c49d83",
              position: "bottom-left",
              transition: "bounce",
              type: "warning"
            });
            console.log(err);
          });
      }
    };

    //ÏãúÎèÑ Î¶¨Ïä§Ìä∏ Í∞ÄÏ†∏Ïò§Í∏∞
    store
      .dispatch("root/requestSidoCodeList")
      .then(function(result) {
        state.sidoList = result.data.sidoList;
      })
      .catch(function(error) {
        console.log(error);
      });

    //Í∞ïÏïÑÏßÄ ÌíàÏ¢Ö Îç∞Ïù¥ÌÑ∞ ÏùΩÏñ¥Ïò§Í∏∞
    const readDogTypeList = function() {
      store.dispatch("root/requestDogTypeList").then(function(result) {
        state.dogTypeList = result.data.dogTypeList;
        state.dogTypeList.push({ id: 17, name: "Í∏∞ÌÉÄ" });
      });
    };

    //ÏãúÎèÑÏóê ÎßûÎäî Íµ¨Íµ∞ Î¶¨Ïä§Ìä∏ Í∞ÄÏ†∏Ïò§Í∏∞
    const gugunList = function(selectedSidoCode) {
      state.board.gugun = {};

      store
        .dispatch("root/requestGugunCodeList", selectedSidoCode)
        .then(function(result) {
          state.gugunList = result.data.gugunList;
        })
        .catch(function(error) {
          console.log(error);
        });
    };

    const gugunInitList = function(selectedSidoCode) {
      store
        .dispatch("root/requestGugunCodeList", selectedSidoCode)
        .then(function(result) {
          state.gugunList = result.data.gugunList;
        })
        .catch(function(error) {
          console.log(error);
        });
    };

    //ÌååÏùº ÏóÖÎ°úÎìú Ïãú Ìò∏Ï∂ú
    const changeFile = function(fileEvent) {
      if (
        fileEvent.target.files &&
        fileEvent.target.files[0].size > 3 * 1024 * 1024
      ) {
        createToast("ÌååÏùº ÏÇ¨Ïù¥Ï¶àÍ∞Ä 3MBÎ•º ÎÑòÏñ¥Ïöî üí¨üí¶", {
          hideProgressBar: "true",
          timeout: 4500,
          showIcon: "true",
          toastBackgroundColor: "#c49d83",
          position: "bottom-left",
          transition: "bounce",
          type: "warning"
        });
      } else if (fileEvent.target.files && fileEvent.target.files.length > 0) {
        for (var i = 0; i < fileEvent.target.files.length; i++) {
          const file = fileEvent.target.files[i];
          state.thumbnailList.push(URL.createObjectURL(file));
          state.newAddFile.push(file);
        }
      }
    };

    const deleteOriginFile = function(index) {
      state.deleteList.push(state.board.fileList[index]);
      state.board.fileList.splice(index, 1);
    };

    const deleteNewFile = function(index) {
      state.thumbnailList.splice(index, 1);
      state.newAddFile.splice(index, 1);
    };

    onMounted(() => {
      store.commit("root/setBreadcrumbInfo", {
        isHome: false,
        title: "ÏûÖÏñë/ÏûÑÎ≥¥",
        path: "/adopt",
        subTitle: "ÏûÖÏñë/ÏûÑÎ≥¥ Í≥µÍ≥† ÏàòÏ†ï"
      });
      readDogTypeList();
      gugunInitList(state.board.sido.id);
      window.scrollTo(0, 0);
    });

    return {
      state,
      gugunList,
      changeFile,
      deleteOriginFile,
      deleteNewFile,
      modifyData,
      readDogTypeList
    };
  }
};
</script>

<style scoped>
:deep(.el-radio__inner:hover) {
  border-color: #755744;
}
:deep(.el-radio.is-bordered.is-checked) {
  border-color: #755744;
  background-color: #f9f0e7;
  color: #755744;
  font-weight: 600;
}

li.el-select-dropdown__item.selected {
  color: #755744;
  font-weight: 700;
}

:deep(.el-radio__inner) {
  display: none;
}
:deep(.el-radio__input.is-checked + .el-radio__label) {
  border-color: #755744;
  color: #755744;
}

:deep(.el-radio__input.is-checked .el-radio__inner) {
  border-color: #755744;
  background-color: #755744;
  background: #755744;
}
:deep(.el-button) {
  font-weight: 600;
}
:deep(.el-button:hover) {
  color: #f9f0e7;
  border-color: #755744;
  background-color: #755744;
}

:deep(.el-textarea__inner) {
  resize: none;
}

:deep(.el-input__inner:focus) {
  border: 1px solid #755744;
}

:deep(.el-textarea__inner:focus) {
  border: 1px solid #755744;
}

:deep(.el-radio-button__inner:hover) {
  color: #d7aea4;
}

:deep(.el-button--primary) {
  color: #755744;
  border-color: #f9f0e7;
  background-color: #f9f0e7;
}
:deep(.el-radio-button__orig-radio:checked + .el-radio-button__inner) {
  border-color: #755744;
  background-color: #755744;
  box-shadow: -1px 0 0 0 #755744;
}

:deep(.el-select-dropdown__item.selected) {
  color: #755744;
}
:deep(.el-select .el-input.is-focus .el-input__inner) {
  border-color: #755744;
}
:deep(.el-switch.is-checked .el-switch__core) {
  border-color: #755744;
  background-color: #755744;
}

:deep(.el-form-item__label) {
  font-size: 12pt;
  font-weight: 500;
}
</style>
